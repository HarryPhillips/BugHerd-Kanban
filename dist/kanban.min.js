/*
*   @type javascript
*   @name config.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name events.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name states.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name buffer.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name cache.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name util.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name node.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name interactor.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name counter.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name http.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name router.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name modal.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name console.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name gui.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*    @type javascript test
*    @name main.test.js
*    @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name main.js
*   @copy Copyright 2015 Harry Phillips
*/

/*
*   @type javascript
*   @name kanban.js
*   @copy Copyright 2015 Harry Phillips
*/

!function(){define("config",{appName:"kbs",appFullname:"Kanban",version:"1.1.0",enabled:!0,mode:"dev",httpToken:"Fw43Iueh87aw7",logs:{enabled:!0,gui:!0,contexts:!0,contextFlag:"context:",obj2buffer:!1,filter:!1},gui:{enabled:!0,autorefresh:!0,console:{state:"kbs-close",autoscroll:!0,icons:{save:"file-text",clear:"trash",toggle:"terminal",close:"times",destroy:"unlink",example:"plus-circle",expand:"caret-square-o-right"}}},interactor:{enabled:!0},events:{silent:!1},cookies:{enabled:!0,prefix:"__kbs_"},routes:{console:{save:"endpoint/SaveBuffer.php"}},tooltips:{save:"Save the output buffer to text file",clear:"Clear all logs",toggle:"GUI Console State",close:"Close the console",destroy:"Destroy this console instance"}}),define("src/components/events",["config"],function(e){function t(){this.topics={}}return t.prototype.subscribe=function(e,t){this.topics[e]||(this.topics[e]=[]),this.topics[e].push(t)},t.prototype.publish=function(t,n){if(this.topics[t]){var o;for(o=0;o<this.topics[t].length;o+=1)this.topics[t][o](n);"object"!=typeof n&&(n={data:n})}else if(!e.events.silent)throw new Error("Event '"+t+"' does not exist!")},new t}),define("src/components/status",{app:!1,interactor:{taskDetailsExpanded:!1},gui:!1,console:!1}),define("src/components/buffer",[],function(){function e(e){t.push(e||""),this.index=t.length-1}var t=[];return e.prototype.writeToBuffer=function(e){var n=this.index;return"string"==typeof t[n]?void(t[n]+=e):t[n]instanceof Array?void t[n].push(e):void 0},e.prototype.removeFromBuffer=function(e){var n,o=this.index;return"string"==typeof t[o]?void(t[o]=t[o].replace(e,"")):t[o]instanceof Array?(n=t[o].indexOf(e),void t[o].splice(n,1)):void 0},e.prototype.getBuffer=function(){return t[this.index]},e.prototype.getGlobalBuffer=function(){return t},e.prototype.clearBuffer=function(){var e=this.index;t.splice(e,1)},e}),define("src/components/cache",["./buffer"],function(e){var t={app:new e,console:new e};return t}),define("src/util",["config","./components/events","./components/status","./components/cache"],function(e,t,n,o){var s={};return s.zerofy=function(e,t){for(;e.toString().length<(t||2);)e="0"+e;return e},s.spacify=function(e,t){for("string"!=typeof e&&(e=e.toString());e.length<t;)e=" "+e;return e},s.ftime=function(){var e=new Date,t=s.zerofy(e.getHours()),n=s.zerofy(e.getMinutes()),o=s.zerofy(e.getSeconds()),i=s.zerofy(e.getMilliseconds(),3);return t+":"+n+":"+o+"."+i},s.fdate=function(){var e=new Date,t=s.zerofy(e.getFullYear(),4),n=s.zerofy(e.getMonth(),2),o=s.zerofy(e.getDate(),2);return t+"-"+n+"-"+o},s.escapeRegEx=function(e){var t;return t=String(e).replace(/([\-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},s.cookie={get:function(t){var n,o,s=e.cookies.prefix+t+"=",i=document.cookie.split(";");for(n=0;n<i.length;n+=1){for(o=i[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(s))return o.substring(s.length,o.length)}return""},set:function(t,n,o){var s,i;o?(i=new Date,i.setTime(i.getTime()+24*o*60*60*1e3),s="; expires="+i.toGMTString()):s="",document.cookie=e.cookies.prefix+t+"="+n+s+"; path=/"},del:function(e){s.cookie.set(e,"",-1)},exists:function(e){var t=s.cookie.get(e);return""!==t&&null!==t&&void 0!==t}},s.isNode=function(e){return"Node"===e.constructor.name},s.isDomElement=function(e){return"object"==typeof window.HTMLElement?e instanceof window.HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},s.isArray=function(e){return e instanceof Array||"Array"===e.constructor},s.contains=function(e,t,n){var o,i,r,c=0,a=[];if("undefined"==typeof e||""===e)throw new Error("Could not determine a contained value, haystack object is undefined!");if("undefined"==typeof t||""===t)return!1;if(i=function(e,t){if(!n)return-1!==e.indexOf(t);if(t=s.escapeRegEx(t),o=new RegExp("(\\W|^)"+t+"(\\W|$)"),s.isArray(e)){for(;c<e.length;)o.test(e[c])&&a.push(c),c+=1;return n?0===a.length?!1:a.length>1?a:a[0]:!0}return o.test(e)?!0:!1},n=n||!1,!s.isArray(t))return i(e,t);for(c=0;c<t.length;c+=1)if(r=i(e,t[c]),r!==!1)return r;return!1},s.swap=function(e,t,n){var o=e[t];e[t]=e[n],e[n]=o},s.log=function(i,r,c,a){function l(){a=c,c=r,r=i}if(e.logs.enabled){var d,u=0,p=[],f=e.logs.filter,h=[],g="",m=!1,y=!1,b="",x="",v="",k=e.logs.contextFlag,w=e.logs.contextClearFlag;for(d in arguments)arguments.hasOwnProperty(d)&&p.push(arguments[d]);if(e.logs.contexts?"string"==typeof i?-1!==i.indexOf(k)?s.log.currentContext!==!1?(y=i.replace(k,""),i=s.log.currentContext,p.shift()):(i=i.replace(k,""),p.shift()):-1!==i.indexOf(w)?p.shift():(l(),i=s.log.currentContext):(l(),i=s.log.currentContext):(-1!==i.indexOf(k)?p.shift():l(),i=!1,y=!1),p.length>2?"object"==typeof c&&(m=c,c=a):p.length>1?"object"==typeof r?(m=r,r="log"):"object"==typeof c&&(m=c,c=""):(c=r,r="log","object"==typeof c&&(m=c,c="")),!f||s.contains(f,r,!0)===!1)for(g+=s.ftime(),g+=" ["+(y||i||e.appName)+"]",g+=" ["+r+"]:> ",g+=c,h.push(g),m&&(x="Object "+JSON.stringify(m,null,4)),v=g.replace(/\s/g," "),v=encodeURIComponent(v),v+=e.logs.obj2buffer?""!==x?"\n"+x:"":""!==x?"\n[object omitted]":"",v+="\n",o.console.writeToBuffer(v),e.logs.gui&&n.console&&(b=g.replace(/\s/g," "),t.publish("gui/log",{msg:b,type:r,obj:x,context:i,subcontext:y})),window.console[r]||(r="log"),m&&h.push(m);u<h.length;)window.console[r](h[u]),u+=1}},s.log.currentContext=s.log.currentContext||!1,s.log.beginContext=function(t){return e.logs.contexts?-1!==t.indexOf(e.logs.contextFlag)?void s.log("error","You shouldn't pass the context flag when using beginContext()"):void(s.log.currentContext=t):void 0},s.log.endContext=function(){s.log.currentContext=!1},s.log.clearContext=function(e){t.publish("gui/contexts/clear",e)},s.log("+ util.js loaded"),s}),define("src/components/node",["config","src/util"],function(e,t){function n(e,t,n){"undefined"!=typeof e.appendChild?this.element=e:(this.settings={type:e,classes:t,id:n},this.element=document.createElement(e),this.element.className=t||"",n&&(this.element.id=n))}return n.prototype.show=function(){this.element.style.display="block"},n.prototype.hide=function(){this.element.style.display="none"},n.prototype.parent=function(){return this.element.parentNode},n.prototype.attr=function(e,t){this.element.setAttribute(e,t)},n.prototype.getClasses=function(){return this.element.className},n.prototype.getId=function(){return this.element.id},n.prototype.hasClass=function(e){var n,o,s=!1;if(t.isArray(e))for(o=e.length,n=0;o>n;n+=1)-1!==this.element.className.indexOf(e[n])&&(s=!0);else-1!==this.element.className.indexOf(e)&&(s=!0);return s},n.prototype.addClass=function(e){""===this.element.className?this.element.className=e:this.element.className+=" "+e},n.prototype.removeClass=function(e){var n,o,s=this.element.className,i=function(e){n=-1!==s.indexOf(" "+e)?s.replace(" "+e,""):-1!==s.indexOf(e+" ")?s.replace(e+" ",""):s.replace(e,"")};if(t.isArray(e))for(n=s,o=0;o<e.length;o+=1)i(e[o]);else i(e);this.element.className=n},n.prototype.setClass=function(e){this.element.className=e},n.prototype.addChild=function(e){return e.constructor===n||e instanceof n?void this.element.appendChild(e.element):void this.element.appendChild(e)},n.prototype.createChild=function(e,t,o){var s=new n(e,t,o);return this.addChild(s.element),s},n.prototype.detach=function(){this.element.parentNode.removeChild(this.element)},n.prototype.attach=function(){this.element.parentNode.appendChild(this.element)},n.prototype.destroy=function(){this.parent().removeChild(this.element),this.element=null},n.prototype.clone=function(){var e=new n(this.settings.type,this.getClasses(),this.getId());return e.element=null,e.element=this.element.cloneNode(),e},n.prototype.text=function(e){return"undefined"==typeof e?this.element.textContent:(e=document.createTextNode(e),this.addChild(e),this)},n.prototype.on=function(e,t){return this.element.addEventListener(e,t),this},n.prototype.writeTo=function(e){"undefined"!=typeof e&&e.appendChild(this.element)},n}),define("src/interactor",["config","src/util","src/components/events","src/components/status","src/components/node"],function(e,t,n,o,s){function i(){t.log("context:inter/init","info","Initialising Interactor..."),c=this,this.init()}var r,c,a=!1;return i.prototype.init=function(){if(!a){if("undefined"==typeof window.jQuery)return void t.log("context:inter/init","error","Interactor could not initialise, jQuery not found!");r=window.jQuery,this.applyWrapper(),this.applyElements(),this.applyHandlers(),this.applyStyles(),a=!0}},i.prototype.isTask=function(e){return!e instanceof r&&(e=r(e)),e=e.closest("[id^=task_]"),e.length?e:!1},i.prototype.getTaskFromComponent=function(e){return e.closest("[id^=task_]")},i.prototype.openTask=function(e){if("undefined"==typeof e)return void this.expandTaskDetails();var t=this.findGlobalId(e||"");r("#task_"+t).trigger("click"),this.expandTaskDetails()},i.prototype.closeTask=function(){this.shrinkTaskDetails()},i.prototype.expandTaskDetails=function(){r(".panelDetail").is(":visible")&&(o.interactor.taskDetailsExpanded||(r(".kbs-overlay").fadeIn(),r(".kbs-details-close").fadeIn(),r(".taskDetails").addClass("kbs-details-expand"),o.interactor.taskDetailsExpanded=!0))},i.prototype.shrinkTaskDetails=function(){o.interactor.taskDetailsExpanded&&(r(".kbs-overlay").fadeOut(),r(".kbs-details-close").fadeOut(),r(".taskDetails").removeClass("kbs-details-expand"),o.interactor.taskDetailsExpanded=!1)},i.prototype.findGlobalId=function(e){var n,o,s,i=r(".task-id"),c=r(".taskID"),a=function(){r(this)[0].textContent===e.toString()&&(n=r(this))};if("undefined"==typeof e&&(e=r(".local_task_id")[0].textContent),t.log("debug","Finding global id for task #"+e),i.each(a),n||c.each(a),"undefined"==typeof n)throw new Error("No task found with id: '"+e+"'!");return n.length<1?(t.log("error","Couldn't find task #"+e),!1):(o=n.parent(),s=o[0].id.replace("task_",""),t.log("debug",o,"Found parent element for task #"+e+" and got global id #"+s),s)},i.prototype.findLocalId=function(e){var t=r("#task_"+e);console.log(t)},i.prototype.applyWrapper=function(){t.log("context:inter/init","+ wrapping bugherd application"),r(".app-wrap").wrap("<div class='kbs-wrapper'></div>")},i.prototype.applyElements=function(){var e,n;t.log("context:inter/init","+ appending elements to bugherd"),e=new s("li"),e.createChild("a").text("Expand Task").on("click",function(){c.openTask()}),n=new s("div","kbs-details-close"),n.createChild("i","fa fa-times"),n.on("click",function(){c.closeTask()}),e.writeTo(r(".nav.main-nav")[0]),n.writeTo(r("body")[0])},i.prototype.applyHandlers=function(){t.log("context:inter/init","+ applying handlers to bugherd"),r(".kbs-wrapper").on("click",function(e){var t=r(e.target),n=c.isTask(t);n&&c.openTask()})},i.prototype.applyStyles=function(){t.log("context:inter/init","+ applying styles to bugherd"),r(".nav.user-menu").css("margin-right","10px")},i}),define("src/components/counter",[],function(){function e(e,t){var n=0,o=!1;this.target=e,this.exec=t,Object.defineProperty(this,"count",{get:function(){return n},set:function(t){n=t,n>=e&&!o&&(o=!0,this.exec())}})}return e}),define("src/components/http",["config","src/util","./counter"],function(e,t){function n(e){this.url=e.url,this.method=e.method||"GET",this.async=e.async||!0,this.data=e.data,this.callbacks={},this.callbacks.success=e.success||function(){},this.callbacks.fail=e.fail||function(){},o=this,e.send&&this.send(this.data)}var o,s=e.httpToken;return n.prototype.encodeData=function(e){var t,n="";for(t in e)e.hasOwnProperty(t)&&(n+=t+"="+e[t]+"&");return s&&(n+="kbstoken="+s),n},n.prototype.send=function(){var e=new XMLHttpRequest;e.open(this.method,this.url,this.async),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){4===this.readyState&&(200===this.status&&this.status<400?(t.log("debug","HTTP 200: "+o.url),o.callbacks.success(this.responseText)):(t.log("debug","HTTP "+this.status+": "+o.url),o.callbacks.fail(this.responseText)))},e.send(o.encodeData(o.data)),e=null},n}),define("src/components/router",["config"],function(e){return{getRoute:function(t,n){return window.KBS_BASE_URL+e.routes[t][n]}}}),define("src/ui/modal",["config","src/util","src/components/events","src/components/http","src/components/status","src/components/node"],function(e,t,n,o,s,i){function r(e,t,n){c=this,"string"!=typeof e&&(n=t,t=e,e=null),a=t,this.type=e,this.node=new i("div","kbs-modal"),this.node.element.style.display="none",e&&this.node.addClass("kbs-"+e),this.onConfirm=n.confirm||function(){},this.onCancel=n.cancel||function(){},this.title=n.title,this.message=n.message,n.init&&this.init()}var c,a;return r.prototype.init=function(){var e,t,n=this.node.createChild("h2","kbs-modal-title"),o=this.node.createChild("p","kbs-modal-msg"),s=this.node.createChild("i","fa fa-times kbs-modal-close");n.element.textContent=this.title,o.element.textContent=this.message,s.element.onclick=function(){c.close()},this.node.addChild(n),this.node.addChild(s),this.node.addChild(o),"prompt"===this.type&&(e=this.node.createChild("span","kbs-confirm"),e.element.textContent="confirm",e.element.onclick=this.onConfirm,t=this.node.createChild("span","kbs-cancel"),t.element.textContent="cancel",t.element.onclick=this.onCancel,this.node.addChild(e),this.node.addChild(t)),a.addChild(this.node.element),this.open()},r.prototype.open=function(){a.tree.main.overlay.show(),this.node.show()},r.prototype.close=function(){a.tree.main.overlay.hide(),this.node.hide()},r.prototype.destroy=function(){a.tree.main.overlay.hide(),this.node.destroy()},r}),define("src/ui/console",["config","src/util","src/components/events","src/components/http","src/components/status","src/components/router","src/components/cache","src/components/node","src/ui/modal"],function(e,t,n,o,s,i,r,c,a){function l(t){if(e.logs.gui){if(d=this,"undefined"==typeof t)throw new Error("No GUI instance passed to Console");u=t,this.buildNodeTree(),this.setContexts(),n.subscribe("gui/contexts/clear",function(e){d.clearContext(e)}),n.publish("kbs/status",{component:"console",status:!0})}}var d,u;return l.prototype.setContexts=function(){this.contexts||(this.contexts={def:d.wrapper.cons.out.element})},l.prototype.getContext=function(t){return e.logs.contexts?this.contexts[t]:this.contexts.def},l.prototype.createContext=function(n,o){if(e.logs.contexts){var s;return this.contexts[n]&&t.log("error","Log context: '"+n+"' is already defined"),t.isNode(o)?s=o.createChild("div","kbs-log-context",n):(s=new c("div","kbs-log-context",n),o.appendChild(s.element)),this.contexts[n]=s.element,o}},l.prototype.clearContext=function(e){"def"!==e&&delete d.contexts[e]},l.prototype.write=function(e){var n,o,s=d.getContext("def"),i=new c("div","kbs-log-node kbs-"+e.type),r=document.createTextNode(e.msg),a=new c("pre","kbs-object"),l=new c("i","fa fa-"+d.getIcon("expand")+" kbs-object-expand"),u=!1;e.context&&(e.subcontext?d.getContext(e.subcontext)?s=d.getContext(e.subcontext):(s=d.getContext(e.context),u=e.subcontext):d.getContext(e.context)?s=d.getContext(e.context):u=e.context),i.addChild(r),e.obj&&(o=document.createTextNode(e.obj),l.element.onclick=function(e){var n=e.target,o=n.parentNode;t.contains(o.className,"kbs-expand")?(o.className=o.className.replace(" kbs-expand",""),n.className=n.className.replace(" kbs-rotate","")):(o.className+=" kbs-expand",n.className+=" kbs-rotate")},a.addChild(l.element),a.addChild(o),i.addChild(a.element)),n=s.parentNode.className,"test"===e.type&&t.contains(n,"kbs-exec")&&i.addClass("kbs-log-close"),s.appendChild(i.element),u&&d.createContext(u,i.element),d.refresh()},l.prototype.createTool=function(t){var n,o=this.wrapper.constools;if("undefined"==typeof o)throw new Error("Could not create new tool, no toolbar!");return n=this.getIcon(t),o[t]=o.createChild("i","fa fa-"+n+" kbs-tool kbs-"+t),o[t].element.title=e.tooltips[t]||"",o[t]},l.prototype.getIcon=function(t){return e.gui.console.icons[t]||"plus"},l.prototype.open=function(){d.wrapper.removeClass("kbs-close"),d.wrapper.addClass("kbs-open")},l.prototype.close=function(){d.wrapper.removeClass("kbs-open"),d.wrapper.addClass("kbs-close")},l.prototype.refresh=function(){var e=d.wrapper.cons.element;e.scrollTop=e.scrollHeight},l.prototype.clear=function(){var e,n=d.wrapper.cons.element,o=d.wrapper.cons.out.element,s=(new Date).getTime();for(n.removeChild(o);o.firstChild;)o.removeChild(o.firstChild);n.appendChild(o),r.console.clearBuffer(),e=(new Date).getTime()-s,t.log("okay","cleared all logs in "+e+" ms")},l.prototype.save=function(){var e,n=(t.ftime(),t.fdate()),s=r.console.getBuffer();t.log.beginContext("log/save"),t.log("info","saving log buffer..."),e=new o({url:i.getRoute("console","save"),method:"POST",send:!0,data:{type:"log",date:n,buffer:s},success:function(e){t.log("context:log/save","okay",e),t.log.endContext(),t.log.clearContext("log/save")}})},l.prototype.destroy=function(){var e="Destroy the Console instance?",t="Confirm destruction of the GUI Console? (irreversible until refresh).",n=new a("prompt",u,{init:!0,title:e,message:t,confirm:function(){var e=d.wrapper.parent(),t=d.wrapper.element;e.removeChild(t),s.console=!1,r.console.clearBuffer(),n.destroy()},cancel:function(){n.close()}})},l.prototype.buildNodeTree=function(){var t,n,o,s,i,r,c;return n="kbs-cons-box "+e.gui.console.state,this.wrapper=t=u.createChild("div",n),o=t.constools=t.createChild("div","kbs-cons-toolbar"),s=o.constitle=o.createChild("div","kbs-cons-title"),i=document.createTextNode(e.appFullname+"v"+e.version),s.addChild(i),this.createTool("toggle").element.onclick=function(){var e=t.hasClass("kbs-close"),n=t.hasClass("kbs-full");e||n||t.addClass("kbs-full"),n&&t.removeClass("kbs-full"),e&&d.open()},-1!==window.KBS_BASE_URL.indexOf("localhost")&&(this.createTool("save").element.onclick=d.save),this.createTool("destroy").element.onclick=d.destroy,this.createTool("clear").element.onclick=d.clear,this.createTool("close").element.onclick=d.close,t.cons=r=t.createChild("div","kbs-cons"),c=r.out=r.createChild("div","kbs-cons-out"),t},l}),define("src/ui/gui",["config","src/util","src/interactor","src/components/events","src/components/counter","src/components/node","src/ui/console","src/ui/modal"],function(e,t,n,o,s,i,r,c){function a(){l=this,this.tree=this.buildNodeTree(),this.console=new r(this),this.modal=new c(this,{init:!1,title:"Test Modal - Title",message:"Test paragraph / modal content."}),this.init(),o.publish("kbs/status",{component:"gui",status:!0})}var l;return t.log("+ gui.js loaded"),a.prototype.init=function(){var n=new s(e.offline?2:3,function(){o.publish("kbs/gui/loaded")}),i=document.createElement("link"),r=document.createElement("link"),c=document.createElement("link"),a=window.KBS_BASE_URL+"css/main.css",d=window.KBS_BASE_URL+"css/"+(e.theme||"theme")+".css",u="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css",p=function(){document.body.appendChild(l.tree.main.element),t.log("context:gui/init","+ attached gui tree"),l.runEventListeners()};e.gui.enabled&&(e.gui.autorefresh&&o.subscribe("gui/update",this.refresh),e.logs.gui&&o.subscribe("gui/log",this.console.write),o.subscribe("kbs/gui/loaded",p)),i.rel="stylesheet",r.rel="stylesheet",c.rel="stylesheet",i.href=a,r.href=d,c.href=u,t.log("context:gui/init","info","Initialising GUI..."),i.onload=function(){t.log("context:gui/init","+ main.css loaded"),n.count+=1},i.onerror=function(){throw n.count+=1,new Error("main.css failed to load!")},r.onload=function(){t.log("context:gui/init","+ theme.css loaded"),n.count+=1},r.onerror=function(){throw n.count+=1,new Error("theme.css failed to load!")},c.onload=function(){t.log("context:gui/init","+ font-awesome.css loaded"),n.count+=1},c.onerror=function(){throw n.count+=1,new Error("font-awesome.css failed to load!")},e.offline||document.head.appendChild(c),document.head.appendChild(i),document.head.appendChild(r)},a.prototype.buildNodeTree=function(){var e,t={};return t.main=e=new i("div","kbs-gui"),e.overlay=e.createChild("div","kbs-overlay"),t},a.prototype.runEventListeners=function(){t.log("context:gui/init","+ running event listeners");var n,o,s=this.console.wrapper.cons.out.element;o=e.logs.contexts?["kbs-exec","kbs-test"]:"",s.onclick=function(e){n=new i(e.target),n.hasClass(o)&&(n.hasClass("kbs-log-close")?n.removeClass("kbs-log-close"):n.addClass("kbs-log-close"))}},a.prototype.refresh=function(){this.console.refresh()},a.prototype.addChild=function(e){this.tree.main.addChild(e)},a.prototype.createChild=function(e,t,n){var o=new i(e,t,n);return this.addChild(o),o},a.prototype.benchmark=function(){var e,n=l.console.wrapper.cons.element,o=l.console.wrapper.cons.out.element,s=(new Date).getTime(),i=0;for(n.removeChild(o);1e4>i;)t.log("debug","log #"+i),i+=1;n.appendChild(o),e=(new Date).getTime()-s,t.log("debug","opt: "+e+"ms")},a.prototype.getCurrentInstance=function(){return l},a}),define("test/main.test",["require","src/util"],function(e,t){function n(){this.modules=["util","components/events"]}return n.prototype.exec=function(n){t.log("context:test/"+n,"exec",'executing test: "'+n+'"...'),e([window.KBS_BASE_URL+"test/"+n+".test.js"])},n.prototype.execAll=function(){var e=this.modules.length,t=0;for(t;e>t;t+=1)this.exec(this.modules[t])},new n}),define("src/main",["config","src/util","src/interactor","src/components/events","src/components/status","src/components/cache","src/components/http","src/ui/gui","test/main.test"],function(e,t,n,o,s,i,r,c,a){var l,d,u,p;e.enabled&&(o.subscribe("kbs/status",function(e){s[e.component]=e.status}),e.gui.enabled&&(u=new c),e.interactor.enabled&&(p=new n),d=function(){window.KBS_DELTA_TIME=(new Date).getTime()-window.KBS_START_TIME+"ms",t.log("okay","Kanban initialised in "+window.KBS_DELTA_TIME),"dev"===e.mode&&(window[e.appName]=l),"undefined"==typeof window.log&&(window.log=t.log),o.publish("kbs/status",{component:"app",status:!0}),e.test&&a.execAll()},l={version:e.version,interactor:p,status:s,cache:i,config:e,events:o,http:r,util:t,gui:u},o.subscribe("kbs/loaded",d),o.publish("kbs/loaded"))}),function(e){var t=e.require,n=document.getElementById("kbs-deposit").classList;e.KBS_GLOBAL_SET="true"===n[0]?!0:!1,e.KBS_START_TIME=n[1],e.KBS_DELTA_TIME="",e.KBS_BASE_URL=n[2],t.config({paths:{src:e.KBS_BASE_URL+"src",test:e.KBS_BASE_URL+"test"}}),"complete"===document.readyState?(e.KBS_START_TIME=(new Date).getTime(),t(["src/main"])):document.onreadystatechange=function(){"complete"===this.readyState&&(e.KBS_START_TIME=(new Date).getTime(),t(["src/main"]))}}(window),define("kanban",function(){})}();